# 1) 基本
http_port 3128
dns_v4_first on

# 2) 解決が不安定な場合は明示的なリゾルバを指定（任意）
# dns_nameservers 1.1.1.1 8.8.8.8

# 3) セキュアなデフォルト：まず全部拒否
acl allowed_domains dstdomain .proxy.golang.org .sum.golang.org .deb.debian.org .security.debian.org
# 追加で許したい先があればここに .example.com を足す

http_access allow localhost
http_access allow allowed_domains
http_access deny all

# 4) HTTPS の CONNECT を許可（目的地は上の allowed_domains に絞られる）
acl SSL_ports port 443
acl Safe_ports port 80      # http
acl Safe_ports port 443     # https
acl CONNECT method CONNECT
http_access allow CONNECT SSL_ports
# （ドメイン制限は dstdomain ACL で効く）

# 5) ログ最小化（任意）
access_log stdio:/var/log/squid/access.log
cache_log stdio:/var/log/squid/cache.log
cache_mem 64 MB
maximum_object_size 8 MB